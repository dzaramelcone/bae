---
milestone: v6.0
audited: 2026-02-16T01:45:00Z
status: passed
scores:
  requirements: 25/25
  phases: 5/5 verified
  integration: 7/7 phase pairs connected
  flows: 7/7 E2E flows complete
gaps:
  requirements: []
  integration: []
  flows: []
tech_debt:
  - phase: 30-agent-core-extraction
    items:
      - "AgenticBackend removed — intentional; agentic fill will use model config on nodes instead"
      - "Phase 30 VERIFICATION.md stale (claims 11/11 but AgenticBackend removed; extract_executable intact)"
---

# v6.0 Graph Runtime — Milestone Audit

**Milestone Goal:** Run bae graphs async inside cortex with concurrent execution, human-in-the-loop input gates, and full observability through the view system.

**Audited:** 2026-02-16
**Status:** passed

## Phase Verification Summary

| Phase | Status | Score | Notes |
|-------|--------|-------|-------|
| 26: Engine Foundation | passed | 8/8 | Re-verified after UAT gap closure (26-03, 26-04) |
| 27: Graph Mode | passed | 12/12 | Re-verified after 3 gap closure plans (27-04, 27-05, 27-06) |
| 28: Input Gates | passed | 5/5 | Initial verification, UAT 6/6 passed |
| 29: Observability | passed | 3/3 + gaps fixed | UAT gaps fixed in 101a5d8 + b171b0b |
| 30: Agent Core Extraction | passed | extract_executable intact | AgenticBackend intentionally removed |

## Requirements Coverage

| Requirement | Phase | Status |
|-------------|-------|--------|
| ENG-01: Graph registry with lifecycle states | 26 | satisfied |
| ENG-02: Engine wraps arun() with lifecycle events | 26 | satisfied |
| ENG-03: Per-node timing and dep durations | 26 | satisfied |
| ENG-04: Backend-agnostic engine | 26 | satisfied |
| ENG-05: dep_cache parameter on arun() | 26 | satisfied |
| MODE-01: GRAPH mode command parsing | 27 | satisfied |
| MODE-02: run \<expr\> evaluates and submits | 27 | satisfied |
| MODE-03: list shows state/timing/node | 27 | satisfied |
| MODE-04: cancel \<id\> revokes graph | 27 | satisfied |
| MODE-05: inspect \<id\> shows trace + timings | 27 | satisfied |
| MODE-06: @gid cross-mode routing | 28 | satisfied |
| GATE-01: asyncio.Future suspension | 28 | satisfied |
| GATE-02: Toolbar badge with count | 28 | satisfied |
| GATE-03: input command resolves gate | 28 | satisfied |
| GATE-04: Schema display (name/type/desc) | 28 | satisfied |
| GATE-05: Shush mode toggle | 28 | satisfied |
| OBS-01: [graph] channel with typed metadata | 29 | satisfied |
| OBS-02: Lifecycle notifications in all modes | 29 | satisfied |
| OBS-03: Debug view shows timings/errors | 29 | satisfied |
| OBS-04: RSS delta per graph | 29 | satisfied |
| OBS-05: asyncio call graph debugging | 29 | satisfied |
| OBS-06: Per-graph output policy | 29 | satisfied |
| INT-01: Graphs as managed tasks | 26 | satisfied |
| INT-02: Events persist to SessionStore | 29 | satisfied |
| INT-03: 10+ concurrent graphs | 29 | satisfied |

**Coverage: 25/25 satisfied**

## Cross-Phase Integration

| Phase Pair | Status |
|------------|--------|
| 26 → 27: Engine → Graph Mode | connected |
| 26 → 28: Engine → Input Gates | connected |
| 26 → 29: Engine → Observability | connected |
| 27 → 28: Commands → Gate Commands | connected |
| 27 → 29: Commands → Debug/Inspect | connected |
| 28 → 29: Gates → Channel Notifications | connected |
| 30 → REPL: Agent Core → AI | connected (extract_executable) |

## E2E Flow Verification

| Flow | Status |
|------|--------|
| 1. Graph execution (run → submit → arun → done → channel → view) | complete |
| 2. Gate suspension (Gate field → hook → Future → resolve → resume) | complete |
| 3. Cross-mode gate resolution (@g → _resolve_gate_input → engine) | complete |
| 4. Observability pipeline (TimingLM → dep hook → RSS → events → store) | complete |
| 5. Error/failure with partial trace (exception → .trace → inspect) | complete |
| 6. Cancel flow (cancel → revoke → CancelledError → CANCELLED) | complete |
| 7. Verbose lifecycle events (logger.info → _NotifyHandler → channel) | complete |

## UAT Gap Closure (Already Completed)

Commit `101a5d8` fixed all 3 UAT gaps from Phase 29:

1. **Duplicate done notification** — Removed `_attach_done_callback`/`_on_done`. Engine `_emit` handles all lifecycle states.
2. **Quiet mode bypass** — "submitted" message now gated by `OutputPolicy.should_emit()`.
3. **Verbose mode missing events** — Standard Python logger in `arun()` for node transitions. `_NotifyHandler` routes `logger.info` to channel when VERBOSE policy active.

Bonus fixes in same commit:
4. **Per-graph gate counter** — Gate IDs now per-graph (g1.0, g2.0) instead of global (g1.0, g2.1).

Commit `b171b0b` added auto-registration:
5. **graph() auto-registers with engine** — `_graph_ctx` contextvar lets `await ootd()` auto-register, getting gate hooks, timing, and lifecycle events automatically.

## Tech Debt

### Phase 30: Stale verification

Phase 30 VERIFICATION.md claims 11/11 truths including AgenticBackend, but AgenticBackend was intentionally removed. The right approach for agentic fill is model config on nodes (REPL sessioning/tool calls via node configuration). The primary deliverable — `extract_executable` extraction to `bae/agent.py` — remains intact.

## Test Suite

**687 passed, 5 skipped** (integration tests skipped in Claude Code)

---

*Audited: 2026-02-16T01:45:00Z*
*Auditor: Claude (milestone-audit)*
