---
status: complete
phase: 32.2-userview-tool-call-stripping
source: [32.2-01-SUMMARY.md, 32.2-02-SUMMARY.md, 32.2-03-SUMMARY.md, 32.2-04-SUMMARY.md]
started: 2026-02-16T23:10:00Z
updated: 2026-02-16T23:30:00Z
---

## Current Test

[testing complete]

## Tests

### 1. Tool calls show diamond-bullet summary format
expected: Navigate into a resource with `source()`, then use a tool like `read("bae")`. The display should show a one-liner like `◆ read(bae) -> str (N lines)` — not a full output dump or framed execution panel.
result: pass
note: "Cosmetic: user wishes diamond bullets were a little brighter. Also: navigation output could be reduced."

### 2. Resource context prefix on tool summaries
expected: While inside a resource (e.g., source), tool summaries show `[source] ◆ read(bae) -> str`. At home (no resource), the prefix is absent — just `◆ ...`.
result: pass

### 3. Error tool calls render in red
expected: Trigger an error tool call (e.g., `read("nonexistent.module")` in source). The tool summary line should render in red/error style with the exception type, like `◆ read(nonexistent.module) -> ResourceError`.
result: issue
reported: "Error type shows as generic 'Error' instead of specific class name like 'ResourceError'. Should use __class__.__name__."
severity: minor

### 4. Intermediate AI prose suppressed
expected: When the AI processes multiple tool calls in sequence, only the final AI response after all tools resolve should display. No intermediate "Let me check that file" or "I'll look at..." prose between tool calls.
result: pass

### 5. Functions table shows typed signatures on resource entry
expected: Navigate into a resource with `source()`. The entry display should show a functions table with `| Tool | Signature | Description |` headers and rows like `| read | <Read:target:str> | ... |`. Write tool shows body-content format with closing tag.
result: pass
note: "Idea: source tools could accept module/symbol targets with types in signatures if those have type annotations."

### 6. Pydantic validation on bad tool params
expected: Call a tool with wrong parameter type, e.g., `read(325035)` (int instead of str). Should return a clear error message showing the expected signature and docstring — not a raw Python TypeError.
result: pass
note: "Validation works. User wishes REPL tracebacks used Rich for nicer formatting."

### 7. Non-tool run-blocks still render as execution panels
expected: Ask the AI to run general Python code (not a simple tool call), e.g., something that uses a variable or loop. It should still render as a framed execution panel with code + output, not as a diamond-bullet summary.
result: pass

## Summary

total: 7
passed: 6
issues: 1
pending: 0
skipped: 0
skipped: 0

## Gaps

- truth: "Error tool summary shows specific exception class name like ResourceError, not generic Error"
  status: failed
  reason: "User reported: Error type shows as generic 'Error' instead of specific class name like 'ResourceError'. Should use __class__.__name__."
  severity: minor
  test: 3
  artifacts: []
  missing: []
