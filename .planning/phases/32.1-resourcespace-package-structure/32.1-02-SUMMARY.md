---
phase: 32.1-resourcespace-package-structure
plan: 02
subsystem: repl
tags: [import-migration, refactor, spaces-package]

requires:
  - phase: 32.1-01
    provides: "spaces/ package layout with re-export shims"
provides:
  - "All test imports using canonical bae.repl.spaces paths"
  - "ai.py cleaned of old bae.repl.resource import in _build_context"
  - "Import audit confirming no stale imports in production code"
affects: [33-tasks-resourcespace, 32.2-userview-tool-stripping]

tech-stack:
  added: []
  patterns: ["Test imports use bae.repl.spaces (canonical), production protocol types stay in bae.repl.resource (definition site)"]

key-files:
  created: []
  modified:
    - tests/test_resource.py
    - tests/test_source.py
    - tests/test_tools_router.py
    - bae/repl/ai.py

key-decisions:
  - "Tests import from bae.repl.spaces (canonical path); production code like tools.py and shell.py keep importing from bae.repl.resource (definition site) -- both are correct"

patterns-established:
  - "Test files always import from bae.repl.spaces, never from bae.repl.resource or bae.repl.source directly"

duration: 2min
completed: 2026-02-16
---

# Phase 32.1 Plan 02: Import Migration Summary

**All test imports migrated from bae.repl.resource/source to bae.repl.spaces; ai.py ResourceHandle import updated; codebase audit clean**

## Performance

- **Duration:** 2 min
- **Started:** 2026-02-16T18:23:24Z
- **Completed:** 2026-02-16T18:25:09Z
- **Tasks:** 2
- **Files modified:** 4

## Accomplishments
- Migrated all three test files (test_resource, test_source, test_tools_router) to import from bae.repl.spaces
- Updated inline imports in test_source.py to use bae.repl.spaces.source.models for helper functions
- Updated ai.py _build_context ResourceHandle import to bae.repl.spaces
- Verified no stale imports remain: zero hits for `from bae.repl.source import` or `from bae.repl.ai import _exec` in production code

## Task Commits

Each task was committed atomically:

1. **Task 1: Migrate test imports to new package paths** - `da47e22` (refactor)
2. **Task 2: Verify ai.py cleanup and final import audit** - `d32e057` (refactor)

## Files Created/Modified
- `tests/test_resource.py` - Import block changed from bae.repl.resource to bae.repl.spaces
- `tests/test_source.py` - Top-level and inline imports migrated to bae.repl.spaces and bae.repl.spaces.source.models
- `tests/test_tools_router.py` - Import block changed from bae.repl.resource to bae.repl.spaces
- `bae/repl/ai.py` - _build_context ResourceHandle import updated to bae.repl.spaces

## Decisions Made
- Tests import from bae.repl.spaces (canonical new path); production infrastructure (tools.py, shell.py) keeps importing from bae.repl.resource (definition site) -- both valid patterns

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered
None.

## User Setup Required
None - no external service configuration required.

## Next Phase Readiness
- Phase 32.1 complete: spaces/ package structure established and all imports migrated
- Ready for Phase 32.2 (UserView tool call stripping) or Phase 33+ (new resourcespaces)
- bae.repl.resource.py remains canonical definition site; bae.repl.spaces re-exports everything

---
*Phase: 32.1-resourcespace-package-structure*
*Completed: 2026-02-16*
